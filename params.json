{"name":"Villa Pisani in Bagnolo","tagline":"3D rappresentation of Villa Pisani by Andrea Palladio, made by Alessio Conte","body":"## Villa Pisani in Bagnolo\r\n<br>\r\n<br>\r\n###THE VILLA\r\nThe Villa Pisani is a patrician villa designed by Andrea Palladio, located in Bagnolo, a small settlement in the comune of Lonigo in the Veneto region of Italy.\r\n\r\n![villa_pisani](https://github.com/Pronte/cg-final-project/raw/master/images/front2.jpg)\r\n*Front view of Villa Pisani.*\r\n\r\n<br>\r\n<br>It is considered the most representative work of the architect's juvenile period.\r\nPalladio started designing Villa Pisani in 1541, just after returning from his first trip to Rome.\r\nThe villa was then built within 1544 and 1545; it was the beginning of a glorious collaboration between the architect and the *Serenissima*.\r\n<br>The Pisani were a rich family of Venetian nobles who owned several Villas Pisani, two of them designed by Andrea Palladio. The villa at Bagnolo was built in the 1540s and represents Palladio's first villa designed for a patrician family of Venice: his earlier villa commissions were from provincial nobility in the Vicenza area. The villa at Bagnolo was at the centre of an agricultural estate, as were most of the villas commissioned from Palladio. It was designed with rusticated features to complement its rural setting; in contrast, the Villa Pisani at Montagnana in a semi-urban setting utilizes more refined motifs.\r\nIn 1570 Palladio published a version of the villa in his Four Books of Architecture.\r\n![Original project of Villa Pisani](https://github.com/Pronte/cg-final-project/raw/master/images/villa-pisani-on-palladio-book.jpg)\r\n*Original project of Villa Pisani*\r\n<br>\r\n<br>The executed villa differs noticeably from the design. The deviations may have been in response to certain conditions on the actual site.\r\nAn engraved ground plan of 1778 by Ottavio Bertotti Scamozzi, gives a clear idea of the villa as it appeared in the 18th century. There was originally a a long barchessa (wing) at the back of the courtyard terminating in dovecotes that kept the villa supplied with squab; this wing was admired by Vasari, but it was demolished in the nineteenth century and replaced by a structure that bears no relation to the Palladian facade it faces.\r\n![Ground plan of the villa by Ottavio Bertotti Scamozzi](https://github.com/Pronte/cg-final-project/raw/master/images/villa-pisani-bertotti-plant.jpg)\r\n*Ground plan of the villa by Ottavio Bertotti Scamozzi*\r\n<br>\r\n<br>The interior features a central T-shaped salone with barrel vaulting inspired by Roman baths; it is decorated with frescoes.\r\nIn 1996, UNESCO included the villa in the World Heritage Site \"City of Vicenza and the Palladian Villas of the Veneto\".\r\n\r\n######Sources:\r\n[villapisani.net](http://www.villapisani.net/) /\r\n<a href=\"http://en.wikipedia.org/wiki/Villa_Pisani_(Bagnolo)\">Wikipedia-en</a> /\r\n<a href=\"http://it.wikipedia.org/wiki/Villa_Pisani_(Bagnolo)\">Wikipedia-it</a>\r\n\r\n###ANALYZING THE VILLA\r\n<br>The model is based on Villa Pisani as it appears now.\r\n<br>This is because there was little documentation about the original version, and it was not enough to make a faithful reproduction of the villa.\r\n<br>On the other hand, there were a good amount of pictures of the current version on the web.\r\n\r\n<br>After gathering some images of the villa (most of which from the same sources quoted above) I noticed that the two towers and the two facades were respectively equal to each other, so one side of the building could be obtained simply by scaling the other side by a -1 factor.\r\n\r\n<br>With this considered, the villa was decomposed in three (two, in fact) main sections:\r\n* The central part\r\n* The right side\r\n* The left side (as said, just the scaled version of the right side)\r\n<br>\r\n<br>\r\n\r\n####THE CENTRAL PART (THE FACADE)\r\nThis part includes the facade, the roof, and few elements of the backside (the half-rose window, the back door and the stairs on the back).\r\nThe facade is the most complex part of the villa.\r\nIt's main parts are a portico and a tympanum, which can be found in most of Palladio's villas, and the circular steps.\r\n<br>The portico is  is characterized by six pilasters (fake columns), placed on the portico's piers to give the impression that they are real columns.\r\n![Facade of Villa Pisani](https://github.com/Pronte/cg-final-project/raw/master/images/front-mq-cut.jpg)\r\n*Facade of Villa Pisani*\r\n<br>Inside the portico there are two simpler pilasters, doors which connect it with the two towers, and the front door as well.\r\n###THE SIDE\r\nThe side of the villa can be itself decomposed in these parts:\r\n* The tower\r\n* The side wall\r\n* The back wall\r\n* The base (upper part of the basement)\r\n\r\n###THE CODE\r\nFor the realization of this model I tried to disassemble each part of the villa into it's smallest elements, and then reassemble them hierarchically, to enhance the re-usability and the readability of the code.\r\nAll the elements are created in local coordinates.\r\nIf an element is composed by multiple parts, the parts are created separately in local coordinates, then assembled together.\r\nDoing so gives the chance to re-use all the elements (single ones and composed ones) multiple times for multiple purposes,  and avoids having to make the same object twice.\r\n\r\nWhen possible, I tried to use the shortcuts of Plasm language and keep the functional approach.\r\nHowever, I made a few (really few!) exceptions to reduce the execution time of the code.\r\n\r\nFor example, instead of this:\r\n```\r\nvar colonna = mkColonna();\r\n\tcolonna.translate([0,2],[dimTorre+intermezzoTorreColonne,2.2]);\r\nvar tCol1 = T([0])([dimColonna + intermezzoColonnaColonna]);\r\nvar tCol2 = T([0])([lArcata + dimColonna]);\r\nvar colonne = STRUCT([colonna,tCol1,colonna,tCol2,colonna,tCol2,colonna,tCol2,colonna,tCol1,colonna]);\r\n```\r\nwhich is short, nice and clean,\r\n<br>I used this:\r\n```\r\nvar colonna = mkColonna();\r\n\tcolonna.translate([0,2],[dimTorre+intermezzoTorreColonne,2.2]);\r\n\tvar tCol1 = T([0])([dimColonna + intermezzoColonnaColonna]);\r\n\tvar tCol2 = T([0])([3 + dimColonna]);\r\n\r\n\tvar colonna2 = tCol1(colonna);\r\n\tvar colonna3 = tCol2(colonna2);\r\n\tvar colonna4 = tCol2(colonna3);\r\n\tvar colonna5 = tCol2(colonna4);\r\n\tvar colonna6 = tCol1(colonna5);\r\nvar colonne = STRUCT([colonna,colonna2,colonna3,colonna4,colonna5,colonna6]);\r\n```\r\nwhich is longer, but reduces the execution time by almost 2 seconds, since the columns are the elements with the highest number of polygons in the whole villa, and in the second way the generation of a few unnecessary clones is avoided.\r\n###UTILITIES\r\nTo make the implementation easier I used a few utility functions.\r\nBetween the most useful there were those that shortened the code, like:\r\n```\r\nvar mkNub = function(cp,grade,sel){\r\n\tsel = sel || S0;\r\n\tgrade = grade || 1;\r\n\tif (grade == 1 ){\r\n\t\treturn NUBS(sel)(1)(mkKnotsG1(cp))(cp);\r\n\t} else {\r\n\t\treturn NUBS(sel)(2)(mkKnotsG2(cp))(cp);\r\n\t}\r\n}\r\nvar mkNubSurfaceWithCPointsAndGrades = function (cps, curvesGrade, surfGrade){\r\n\tcurvesGrade = curvesGrade || 1;\r\n\tsurfGrade = surfGrade || 1;\r\n\tvar handles = cps.map(function(cp){return mkNub(cp,curvesGrade,S0);});\r\n\treturn mkNub(handles,surfGrade,S1);\r\n}\r\n```\r\nThis and other functions made me avoid writing the same things over and over again.\r\n\r\nTo reduce the load time of the model, I used a map that specified the segmentation for the most complex part of it.\r\nIn this way, all that was needed to change the segmentation of the whole villa was to switch to the desired map.\r\nDuring the developing, for example, I used as few polygons as possible, so I could load the entire model when I needed it without wasting too much time.\r\n```\r\nvar resMapHRes = {\r\n\t\"capitello\" : [20,20],\r\n\t\"blocco\" : [12,15],\r\n\t\"bloccoBase\" : [8,5],\r\n\t\"retroArco\" : [30,3],\r\n\t\"cunetta\" : [15,1],\r\n\t\"cunettaAlta\" : [42,1],\r\n\t\"cupolaPortico\" : [42,20],\r\n\t\"soffittoPortico\" : [1,42],\r\n\t\"puntale\" : [25,4],\r\n\t\"gradiniCircolari\" : [64],\r\n\t\"rosone\" : [64]\r\n};\r\nvar resMapMRes = {\r\n\t\"capitello\" : [20,20],\r\n\t\"blocco\" : [12,10],\r\n\t\"bloccoBase\" : [8,4],\r\n\t\"retroArco\" : [30,3],\r\n\t\"cunetta\" : [10,1],\r\n\t\"cunettaAlta\" : [28,1],\r\n\t\"cupolaPortico\" : [28,28],\r\n\t\"soffittoPortico\" : [1,28],\r\n\t\"puntale\" : [15,4],\r\n\t\"gradiniCircolari\" : [32],\r\n\t\"rosone\" : [32]\r\n};\r\nvar resMapLRes = {\r\n\t\"capitello\" : [10,10],\r\n\t\"blocco\" : [6,3],\r\n\t\"bloccoBase\" : [6,3],\r\n\t\"retroArco\" : [10,3],\r\n\t\"cunetta\" : [10,1],\r\n\t\"cunettaAlta\" : [18,1],\r\n\t\"cupolaPortico\" : [18,18],\r\n\t\"soffittoPortico\" : [1,18],\r\n\t\"puntale\" : [8,4],\r\n\t\"gradiniCircolari\" : [8],\r\n\t\"rosone\" : [16]\r\n};\r\nvar resMap = resMapHRes;\r\n```\r\n\r\n###REPRODUCING THE PARTS\r\n####THE ROOF\r\nMaking the roof was quite simple, Once I found the vertexes I used the `TRIANGLE_STRIP` function, which creates a surface made of triangles having as vertexes the points in input.\r\n####THE FACADE\r\nAs I said before, the facade is the most complex (and hardest to model) part of the villa.\r\nThe blocks of the pilasters and the arches were made one by one, and then copied of course to make the other arches and pilasters.\r\nTo make the blocks I wrote this function:\r\n```\r\nvar mkCustomBlocco = function (cpoints,spessore,n1,n2,durezzaCurva,grado){ //control points su X,Z !\r\n\tif(cpoints == undefined){\r\n\t\tconsole.log(\"NO CONTROL POINTS FOR THIS BLOCK!\")\r\n\t\treturn undefined;\r\n\t}\r\n\tvar spess = spessore || 0.2;\r\n\tvar n = n1 || resMap[\"blocco\"][0];\r\n\tvar durezza = durezzaCurva || 2;\r\n\tvar g = grado || 2;\r\n\r\n\tvar detail = n2 || resMap[\"blocco\"][1];\r\n\tvar domain2 = D11([n,detail]);\r\n\tvar base = mkNub(cpoints,g,S0);\r\n\r\n\tvar csopra = cpoints.map(function(p){return [p[0],spess,p[2]]});\r\n\tvar sopra = mkNub(csopra,g,S0);\r\n\tvar xEnd = 0;\r\n\tvar yEnd = spess;\r\n\tvar zEnd = 0;\r\n\r\n\tfor (var i in cpoints){\r\n\t\txEnd += cpoints[i][0];\r\n\t\tzEnd += cpoints[i][2];\r\n\t}\r\n\txEnd = xEnd/cpoints.length;\r\n\tzEnd = zEnd/cpoints.length;\r\n\r\n\tpEnd = [xEnd,yEnd,zEnd];\r\n\tvar puntoDiChiusura = function(){return pEnd;}\r\n\r\n\tvar controls = [base];\r\n\tfor(var i = 0; i<durezza; i++){\r\n\t\tcontrols.push(sopra);\r\n\t}\r\n\tcontrols.push(puntoDiChiusura);\r\n\tvar surf = BEZIER(S1)(controls);\r\n\tvar dsurf = MAP(surf)(domain2);\r\n\treturn dsurf;\r\n}\r\n```\r\nWhich can build a block with custom length, height, depth and segmentation, and of course had default values.\r\n![comparison-front](https://github.com/Pronte/cg-final-project/raw/master/screenshots/front-comparison.jpg)\r\n*Comparison between the front side of the villa and the one of the model*\r\n<br>\r\n####THE TOWER\r\nEven if the walls of the tower are quite similar to the ones of the side wall, their height and their upper window differ (the basement window in the side of the tower is different as well), the lower window through was the same, so it was used for both.\r\n![details](https://github.com/Pronte/cg-final-project/raw/master/screenshots/details.png)\r\n*Detail of the tower, the side wall element, and door/window*\r\n<br>\r\nFor some reason also the back door was exactly like the windows, so I made it with a customized version of a window without the glass and the window sill.\r\n\r\n####THE WALLS AND THE BASE\r\nAs seen in the picture above, the walls of the villa made by replying the same element multiple times.\r\nIn a hierarchical view the basement wasn't a single element together with the walls, but since the windows had a 1 to 1 matching with the openings in the basement I decided to simplify things and make a single unit-element that included both.\r\n####THE BACK side\r\n![comparison-back](https://github.com/Pronte/cg-final-project/raw/master/screenshots/retro-comparison.jpg)\r\n*Comparison between the back side of the villa and the one of the model*\r\n<br>\r\nHere the most complex part was the half-rose window.\r\nI made the round part with this funciton:\r\n```\r\n\t//crea la parte della corona circolare di raggio interno rInt e raggio esterno rEst\r\n\t//che va da alfa1 a alfa2, campionata n volte, e estrusa di h.\r\nvar mkPartOfCoronaCircolare = function(rInt,rEst,h,alfa1,alfa2,n){\r\n\tvar domain = DOMAIN([[rInt,rEst],[alfa1,alfa2],[0,1]])([1,n,1]);\r\n\tvar mapping = function(p){\r\n\t\tvar r = p[0];\r\n\t\tvar alfa = p[1];\r\n\t\tvar dh = p[2];\r\n\t\treturn [r*COS(alfa),r*SIN(alfa),h*dh];\r\n\t}\r\n\treturn MAP(mapping)(domain);\r\n}\r\n```\r\nAnd the wall had to be round as well, so I made this:\r\n```\r\n\t//crea la forma che si ottiene prendendo il quadrato di lato r con vertice in basso a sinistra nell'origine,\r\n\t//e sottraendo ad esso la parte nel primo quadrante della circonferenza di raggio r centrata nell'origine.\r\n\t//poi estrude dello spessore in input (spess)\r\n\t//n e' il numero di slices della circonferenza.\r\nvar mkComplementareQuartoDiCirconferenzaSolido = function(r,spess,n){\r\n\tvar points = [[r,r]];\r\n\tvar alfa;\r\n\tvar p;\r\n\r\n\tfor (var i =0; i<=n; i++){\r\n\t\talfa = (i*PI/2)/(n);\r\n\r\n\t\tp = [r*COS(alfa),r*SIN(alfa)];\r\n\t\tpoints.push(p);\r\n\t}\r\n\r\n\tvar compl2D = TRIANGLE_FAN(points);\r\n\r\n\tvar compl = EXTRUDE([spess])(compl2D);\r\n\treturn compl;\r\n}\r\n\r\n```\r\n\r\n####ASSEMBLING\r\nThanks to the hierarchical decomposition, the final assemble of the villa took \"only\" about one hundred lines.\r\nAll the macro elements were created and put in the right place with `R`, `T` and `S` functions.\r\nThere are a few parameters too: they can customize certain features of the villa, like the space between some elements or the size of certain doors (which modify the walls and all the necessary).\r\n\r\n\r\n##PICTURES\r\nMore pictures of the villa and the model can be found at:\r\nhttps://github.com/Pronte/cg-final-project/tree/master/screenshots\r\nhttps://github.com/Pronte/cg-final-project/tree/master/images\r\n######Some of the pictures were taken from wikipedia according to the GP Licence. Other were taken from google images. I own none of the pictures of Villa Pisani, and there was no copyright infringement intended.\r\n\r\n![side-back](https://github.com/Pronte/cg-final-project/raw/master/screenshots/side-retro.png)\r\n*Side and back of the villa*\r\n<br>\r\n![front](https://github.com/Pronte/cg-final-project/raw/master/screenshots/front.png)\r\n*Front view of the villa and the roof*\r\n\r\nThank you for the attention.\r\nAnd thanks to Professor Alberto Paoluzzi and his assistants Enrico Marino and Federico Spini for the knowledge shared during the Computational Graphics course.","note":"Don't delete this file! It's used internally to help with page regeneration.","google":""}